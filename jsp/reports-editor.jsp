<%@ include file="template-top-page.shtml"%>
<%@ include file="callHelp.js"%>
<DIV id="printStatus2" style="position:absolute; visibility:hidden; z-index:0; left: 550px; top: 5px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>printing.gif">
    </td>
  </tr>
</table>
</div>

<DIV id="printStatusOld" style="position:absolute; visibility:hidden; z-index:0; left: 550px; top: 5px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    Building report...
    </td>
  </tr>
</table>
</div>

<DIV id="gatheringOld" style="position:absolute; visibility:hidden; z-index:0; left: 550px; top: 5px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    Gathering data...
    </td>
  </tr>
</table>
</div>

<DIV id="percentage" style="position:absolute; visibility:hidden; z-index:0; left: 650px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <input type="text" name="percent" value="0%" size="5" READONLY>
    </td>
  </tr>
</table>
</div>



<DIV id="downloading" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>downloading.gif">
    </td>
  </tr>
</table>
</div>


<DIV id="gathering0" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>gathering-0.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="gathering10" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>gathering-01.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="gathering20" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>gathering-02.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="gathering30" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>gathering-03.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="gathering40" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>gathering-04.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="gathering50" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>gathering-05.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="gathering60" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>gathering-06.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="gathering70" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>gathering-07.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="gathering80" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>gathering-08.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="gathering90" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>gathering-09.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="gathering100" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>gathering-10.gif">
    </td>
  </tr>
</table>
</div>





<DIV id="printStatus0" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>building-0.gif">
    </td>
  </tr>
</table>
</div>

<DIV id="printStatus10" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>building-01.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="printStatus20" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>building-02.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="printStatus30" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>building-03.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="printStatus40" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>building-04.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="printStatus50" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>building-05.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="printStatus60" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>building-06.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="printStatus70" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>building-07.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="printStatus80" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>building-08.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="printStatus90" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>building-09.gif">
    </td>
  </tr>
</table>
</div>
<DIV id="printStatus100" style="position:absolute; visibility:hidden; z-index:0; left: 455px; top: 10px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <img src="<%= inf.getImageDirectory() %>building-10.gif">
    </td>
  </tr>
</table>
</div>




<%  // This variable holds the value to be placed in the <title> html tag for the include file:
	// template-top-html.jsp.
	String htmlTitle = "Reports";

  //get current report from session
  Report currentReport = (Report)context.getSessionValue("report");

 // this will check the access right for a user
 boolean saveVisible = false;
 if(context.getDelivery("saveVisible") != null)
   saveVisible = ((String)context.getDelivery("saveVisible")).equals("true");

%>

<%@ include file="template-top-html.shtml" %>

<!-- JR - ITS 213 -->
<script>
function HideLayer()
{
 mtbSearch.click();
 //alert('hidding');
 toggle( 'SearchLayer', 'ReportNameSearch');
}
function submitSearch()
{
  // MSC ITS 630 change the target of the form to the default
  document.forms[0].target= "_self";  // change target to the hiddenframe

  toggle( 'SearchLayer', 'ReportNameSearch' );
  document.forms[0].cmd.value = "reports-search";
  showWaitMsg();  // mc its 966 show please wait message
  document.forms[0].submit();
} //end function submitSearch()

function submitList( pType )
{
	if (document.forms[0].OrderByDirection.value == "0") {
		document.forms[0].OrderByDirection.value = "1";
	} else {
		document.forms[0].OrderByDirection.value = "0";
	}

  // MSC ITS 630 change the target of the form to the default
  document.forms[0].target= "_self";  // change target to the hiddenframe

  document.forms[0].OrderBy.value = pType;
  document.forms[0].cmd.value = "reports-sort";
  showWaitMsg();  // mc its 966 show please wait message
  document.forms[0].submit();
} //end function submitList()

</script>
<!-- JR - ITS 213 -->

<SCRIPT LANGUAGE="JavaScript">
<!--

var browserName = navigator.appName;
var browserVersion = navigator.appVersion;
var ieCheck = true;
var printPdflink = "";

var currentReport = "<%= currentReport.getReportName()%>";

if (browserVersion.indexOf("MSIE 5.5") > 0)
{
  ieCheck = true;
  printPdflink = "home?cmd=<%=MilestoneConstants.CMD_REPORTS_PRINT%>";
  printRtflink = "home?cmd=reports-print-rtf";
}
else if (browserVersion.indexOf("MSIE 4.") > 0 || browserVersion.indexOf("MSIE 5.") > 0)
{
  ieCheck = false;
  printRtflink = "home?cmd=reports-print-rtf4";
  printPdflink = "home?cmd=reports-print-pdf4";
}
else
{
  ieCheck = true;
  printPdflink = "home?cmd=<%=MilestoneConstants.CMD_REPORTS_PRINT%>";
  printRtflink = "home?cmd=reports-print-rtf";
}

// -->
</SCRIPT>



<!-- include js files holding javascript functions -->
<SCRIPT type="text/javascript" language="JavaScript" src="<%= inf.getHtmlDirectory() %>include-jscript-toggle.js"></SCRIPT>
<SCRIPT type="text/javascript" language="JavaScript" src="<%= inf.getHtmlDirectory() %>include-jscript-toggle-button.js"></SCRIPT>
<SCRIPT type="text/javascript" language="JavaScript" src="<%= inf.getHtmlDirectory() %>include-jscript-check-format.js"></SCRIPT>
<SCRIPT type="text/javascript" language="JavaScript" src="<%= inf.getHtmlDirectory() %>include-jscript-focus-field.js"></SCRIPT>
<SCRIPT type="text/javascript" language="JavaScript" src="<%= inf.getHtmlDirectory() %>include-jscript-check-length.js"></SCRIPT>
<SCRIPT type="text/javascript" language="JavaScript" src="<%= inf.getHtmlDirectory() %>include-jscript-check-convert-date.js"></SCRIPT>
<SCRIPT type="text/javascript" language="JavaScript" src="<%= inf.getHtmlDirectory() %>include-jscript-check-integer.js"></SCRIPT>
<SCRIPT type="text/javascript" language="JavaScript" src="<%= inf.getHtmlDirectory() %>include-jscript-check-shortcut.js"></SCRIPT>

<SCRIPT type="text/javascript" language="JavaScript">

<%=context.getDelivery("corporate-array")%>

<% // msc 12/04/03 add values array to rebuild list boxex %>
<%= context.getDelivery("family_ValuesArray")%>

  function helpConext()
  {
    callHelp('Help/','Reports.htm');
    mtbHelp.reset();
  }//end function helpContext

function compareText (option1, option2) {
  if (option1.text.toUpperCase() == "ALL")
    return -1;
  else if (option2.text.toUpperCase() == "ALL")
    return 1;
  else
    return option1.text.toUpperCase() < option2.text.toUpperCase() ? -1 : option1.text.toUpperCase()  > option2.text.toUpperCase() ? 1 : 0;
}

/* msc afe 2003 now incldued in include-jscript-check-shortcut.js
function sortSelect (select, compareFunction) {
  if (!compareFunction)
    compareFunction = compareText;
  var options = new Array (select.options.length);
  for (var i = 0; i < options.length; i++)
    options[i] =
      new Option (
        select.options[i].text,
        select.options[i].value,
        select.options[i].defaultSelected,
        select.options[i].selected
      );
  options.sort(compareFunction);
  select.options.length = 0;
  for (var i = 0; i < options.length; i++)
    select.options[i] = options[i];
}
*/

//////////////////////////////////////////////////////
// This function unchecks the all status check box
// if any check box other than all is checked
/////////////////////////////////////////////////////
function clickStatus(obj)
{
  // if object exists
  if(obj)
  {
    // if all checkbox if clicked, check the other boxes
    if(obj.name == "status_all")
    {
        // do active
        clickStatusHelper(document.all.status_active,obj)
        // do closed
        clickStatusHelper(document.all.status_closed,obj)
        // do tbs
        clickStatusHelper(document.all.status_tbs,obj)
        // do cancelled
        clickStatusHelper(document.all.status_cancelled,obj)
    }
    else  // if not the all status check boxd
    {
      // uncheck the all check box
      if(document.all.status_all)
        document.all.status_all.checked = false;
    }
  }
  return;
}

///////////////////////////////////////
// helper function
///////////////////////////////////////
function clickStatusHelper(obj,objAll)
{
  // if object exists
  if(obj)
  {
    // if all object checked
    if(objAll.checked)
    {
       obj.checked = true;
       obj.style.color = "red";
    } else {
       obj.checked = false;
       obj.style.color = "black";
    }
  }
}

//////////////////////////////////////////////////////
// This function unchecks the all dist co check box
// if any check box other than all is checked
/////////////////////////////////////////////////////
function clickDistCo(obj)
{
  // if object exists
  if(obj)
  {
    // if all checkbox if clicked, check the other boxes
    if(obj.name == "distCo0")
    {

        if(obj.checked){
             state = true;
        } else {
             state = false;
        }

        // set alldistCo checkboxes to true
        for (i=0; i<document.reportForm.elements.length; i++){
           if (document.reportForm.elements[i].type == 'checkbox'){
               //if it is named 'distCo' then set to true
               checkboxName = document.reportForm.elements[i].name;
               if (checkboxName.substr(0,6)=="distCo"){
                    document.reportForm.elements[i].checked = state;
               }
           }
        }

    }
    else  // if not the all status check box
    {
      // uncheck the all check box
      if(document.all.distCo0)
        document.all.distCo0.checked = false;
    }
  }
  return;
}

function clickFamily(obj)
{

  if(document.forms[0].environment)
    clearCombo(document.forms[0].environment);

  if(document.forms[0].company)
    clearCombo(document.forms[0].company);

  if(document.forms[0].Label)
    clearCombo(document.forms[0].Label);

  if(document.forms[0].environment)
  {
    populateEnvironment(document.forms[0].environment, obj[obj.selectedIndex].value);
//alert("in clickFamily");
    //clickEnvironment(document.forms[0].environment);
  }

  if(document.forms[0].company)
  {
    populateCompanyFromFamily(document.forms[0].company, obj[obj.selectedIndex].value);
    //clickCompany(document.forms[0].company);
  }

  if(document.forms[0].Label)
  {
    populateLabelFromFamily(document.forms[0].Label,obj[obj.selectedIndex].value);
  }

  return true;
} //end function clickFamily()

function clickEnvironment(obj)
{

  if (obj.selectedIndex == 0 )
    return clickFamily(document.forms[0].family);

//alert("clickEnvironment");
  if(document.forms[0].company) {
//alert("company field found");
    clearCombo(document.forms[0].company);
    populateCompany(document.forms[0].company, obj[obj.selectedIndex].value);
    //clickCompany(document.forms[0].company);
  }
  //else {
    if((document.forms[0].Label)) {
      //alert("step1");
      clearCombo(document.forms[0].Label);
      populateLabelFromEnvironment(document.forms[0].Label,obj[obj.selectedIndex].value)
    }
  //}

  return true;
} //end function clickCompany()


function clickCompany(obj)
{
  objFam = document.forms[0].family;
  objEnv = document.forms[0].environment;

  if (obj.selectedIndex == 0 && (objFam.selectedIndex != 0 || objEnv.selectedIndex != 0))
    return clickEnvironment(document.forms[0].environment);

  if(document.forms[0].Label)
  {
   // alert("clickCompany1a");
    clearCombo(document.forms[0].Label);
    populateLabel(document.forms[0].Label, obj[obj.selectedIndex].value);
  }
  return true;
} //end function clickCompany()


function populateEnvironment(obj, index)
{
   var j = 0;
   for(var i=0; i < familyArray[index].length; i=i+2){
       document.forms[0].environment.options[j] = new Option(familyArray[index][i+1], familyArray[index][i]);
       j++;
   }

   sortSelect(document.forms[0].environment,compareText);
   document.forms[0].environment.options[0].selected=true;
} //end function populateEnvironment()


function populateCompany(obj, index)
{

   var j = 1;

  // MSC AFE 2003 - if all selected
  objEnv = document.forms[0].environment.options;
  //alert(" Env value " + objEnv[objEnv.selectedIndex].value);
  // if selected environment is equal to all, show all companies
  if(objEnv[objEnv.selectedIndex].value == "0")
  {
    //alert(" options company length " + saveCompanyOptions.length);
    if(saveCompanyOptions.length > 0)
    {
      for(var i=1; i < saveCompanyOptions.length; i++)
      {
         document.forms[0].company.options[i] = new Option(saveCompanyOptions[i].text, saveCompanyOptions[i].value);
      }
    }
    else  // empty company drop down
    {
      	document.forms[0].company.options[0] = new Option('All',0);
    }
    document.forms[0].company.options[0].selected=true;
    return true;
  }
  // MSC AFE 2003 - IF ALL SELECTED

   for(var i=2; i < environmentArray[index].length; i=i+2){
	document.forms[0].company.options[j] = new Option(environmentArray[index][i+1], environmentArray[index][i]);
       j++;
   }

   document.forms[0].company.options[0] = new Option('All',0);
   sortSelect(document.forms[0].company,compareText);
   document.forms[0].company.options[0].selected=true;

} //end function populateCompany()

function populateLabel(obj, index)
{
//alert("populateLabel - company index:[" + index + "]");
  var j = 1;

  // MSC AFE 2003 - if all selected
  objEnv = document.forms[0].environment.options;
  objCo = document.forms[0].company.options;
  // if selected environment and company are equal to all, show all labels
 //alert("companyObj - company index:[" + index + "]");
 //alert("companyObj - selected index:[" + objCo[objCo.selectedIndex].value + "]");
  if(objCo[objCo.selectedIndex].value == "0")
  {
    //alert(" options Label length " + saveLabelOptions.length);
    if(saveLabelOptions.length > 0)
    {
      for(var i=0; i < saveLabelOptions.length; i++)
      {
         document.forms[0].Label.options[i] = new Option(saveLabelOptions[i].text, saveLabelOptions[i].value);
      }
    }
    else  // empty label drop down
    {
      	document.forms[0].Label.options[0] = new Option('All',0);
    }
    document.forms[0].Label.options[0].selected=true;
    return true;
  }
  // MSC AFE 2003 - IF ALL SELECTED


  if(companyArray.length >= index){
    if(companyArray[index]){
      for(var i=2; i < companyArray[index].length; i=i+2)
      {
        document.forms[0].Label.options[j] = new Option(companyArray[index][i+1], companyArray[index][i]);
        j++;
      }
    }
  }

  document.forms[0].Label.options[0] = new Option('All',0);
  sortSelect(document.forms[0].Label,compareText);
  document.forms[0].Label.options[0].selected=true;

} //end function populateLabel()


///////////////////////////////////////////////////
function populateCompanyFromFamily(obj, index){
var j = 1;
 //For every entry in the family array
//alert("index:[" + index + "]");
 for(var i=0; i < familyArray[index].length; i=i+2){
    var environmentId = familyArray[index][i];
    //alert("environmentId:[" + environmentId + "]");
    //for every environment entry, get its company
    //if (environmentId ==0)
    //{
      //alert("environmentid is zero so skipping");
      //document.forms[0].company.options[0] = new Option('[none available]',0);
      //document.forms[0].company.options[0] = new Option(environmentArray[environmentId][1], environmentArray[environmentId][0]);
      //j++; // msc 1/03/02, its 294, remove multiple (Alls) in drop down list box
    //} else {
      //alert("about to loop --- environmentId:[" + environmentId + "]");
      for(var m=0; m < environmentArray[environmentId].length; m=m+2)
      {
        var companyId = environmentArray[environmentId][m];
        if(  companyId != 0 ) // msc 1/03/02, its 294 , remove multiple alls in list box
        {
          //alert("add companyid:[" + companyId + "]");
          document.forms[0].company.options[j] = new Option(environmentArray[environmentId][m+1], environmentArray[environmentId][m]);
          j++;
        }
      }
    //}
 }
  document.forms[0].company.options[0] = new Option('All',0);
  sortSelect(document.forms[0].company,compareText);
  document.forms[0].company.options[0].selected=true;

}

///////////////////////////////////////////////////
function populateLabelFromEnvironment(obj, index){
//alert("inside populateLabelFromEnvironment");
var j = 1;
 //For every entry in the environment array
//alert("index:[" + index + "]");
//alert("about to loop --- index:[" + index + "]");
 for(var i=2; i < environmentArray[index].length; i=i+2){
	var companyId = environmentArray[index][i];
	//alert("companyId:[" + companyId + "]");
	//for every company entry, get its label
	//if (companyId==0){
		//alert("companyid is zero so skipping");
          //document.forms[0].Label.options[0] = new Option('All',0);
	//} else {
		//alert("about to loop --- companyId:[" + companyId + "]");
		for(var m=2; m < companyArray[companyId].length; m=m+2){
			var labelId = companyArray[companyId][m];
			//alert("add labelid:[" + labelId + "]");
                        document.forms[0].Label.options[j] = new Option(companyArray[companyId][m+1], companyArray[companyId][m]);
			j++;
		}
	//}
 }
  document.forms[0].Label.options[0] = new Option('All',0);
  sortSelect(document.forms[0].Label,compareText);
  document.forms[0].Label.options[0].selected=true;
}
///////////////////////////////////////////////////
function populateLabelFromFamily(obj, index){
var j = 0;
var jk = 1;
 //For every entry in the family array
//alert("index:[" + index + "]");
 for(var i=0; i < familyArray[index].length; i=i+2){
	//alert("<--- looping on families --->");
	var environmentId = familyArray[index][i];
	//alert("environmentId:[" + environmentId + "]");
	//for every environment entry, get its company
	//if (environmentId ==0){
		//alert("environmentid is zero so skipping");
	//	document.forms[0].Label.options[0] = new Option('All',0);
	//} else {
		//alert("<--- about to loop --- environmentId:[" + environmentId + "] --->");
		for(var m=2; m < environmentArray[environmentId].length; m=m+2){
			var companyId = environmentArray[environmentId][m];
			//alert("add companyid:[" + companyId + "]");
                        //if (companyId ==0){
				//alert("companyId is zero so skipping");
			//	document.forms[0].Label.options[0] = new Option('All',0);
			//} else {
				for(var n=2; n < companyArray[companyId].length; n=n+2){
					var labelId = companyArray[companyId][n];
					//alert("add labelid:[" + labelId + "]");
                                        document.forms[0].Label.options[jk] = new Option(companyArray[companyId][n+1], companyArray[companyId][n]);
					jk++;
				}
			//}
		}
	//}
   }
//alert("end of populateLabelFromFamily");
  document.forms[0].Label.options[0] = new Option('All',0);
  sortSelect(document.forms[0].Label,compareText);
  document.forms[0].Label.options[0].selected=true;
}
///////////////////////////////////////////////////

function clearCombo(obj)
{
  // msc 10/11/03 a faster way to clear the selects options
  /*
  var i;
  for(i=obj.options.length; i >= 0; i--)
	obj.options[i] = null;
   	obj.selectedIndex = -1;
  */
  obj.options.length = 0;

} //end function clearCombo()

function submitResize()
{
  // MSC ITS 630 change the target of the form to the default
  document.forms[0].target= "_self";  // change target to the hiddenframe
  document.all.cmd.value = "reports-editor";

  // call the right command for resizing
  /*
  parent.top.bottomFrame.location = "home?cmd=notepad-toggle&notepadType=<%=MilestoneConstants.NOTEPAD_REPORTS_VISIBLE%>&lastCommand=<%=form.getRenderableValue("cmd")%>";
  */
  parent.top.bottomFrame.location = "home?cmd=notepad-toggle&notepadType=<%=MilestoneConstants.NOTEPAD_REPORTS_VISIBLE%>" + "&lastCommand=" + document.all.cmd.value;
} //end function submitResize()

function hidePrintButtons( pLayer, pFirstFocus )
{
  layer = eval( document.all[ pLayer ] )
  // Check to see if the layer is found (it must be at least an object)
  if ( ( typeof layer ) != "object" )
  {
    return;
  }
  layer.style.visibility = "hidden";
}  // End function toggle

function toggleSearch()
{
	toggle( 'SearchLayer', 'ArtistSearch' );
}// end function toggleSearch
</script>

<script type="text/javascript" language="JavaScript" src="<%= inf.getHtmlDirectory() %>calendar.js"></script>
<script type="text/javascript" language="JavaScript">
var count = 0;
function getCalendar()
{
  layer = eval(document.all["calendar"]);
  if(count == 0)
  {
	layer.style.visibility = "Visible";
	count = 1;
  }
  else
  {
	layer.style.visibility = "Hidden";
	count = 0;
  }
} // end function getCalendar

//ITS 1050 - Added beginEffective and endEffective Dates
function checkField( pField )
{
  var bReturn = true;
  switch( pField.name )
  {


    case "beginDate":
      bReturn = bReturn && checkDate( pField, "Begin Date", true );
      break;
    case "endDate":
      bReturn = bReturn && checkDate( pField, "End Date", true ); //ITS 1050 Fix Alert Message - jo
      break;
    case "beginDueDate":
      bReturn = bReturn && checkDate( pField, "Begin Due Date", true );
      break;
    case "endDueDate":
      bReturn = bReturn && checkDate( pField, "End Due Date", true );
      break;
    case "beginEffectiveDate":
      bReturn = bReturn && checkDate( pField, "Begin Effective Date", true );
      break;
    case "endEffectiveDate":
      bReturn = bReturn && checkDate( pField, "End Effective Date", true );
      break;
  }
  return bReturn;
} // end function checkField()


function submitSave()
{
   /////////////////////////////////////////////////////
   // msc item 2069  begin and end dates must be entered
   /////////////////////////////////////////////////////
   var bReturn = true;

    if( currentReport == "FutDueDate" ) {  // specific to this report
        bReturn = bReturn && checkDate( document.all.beginDate, "Begin Date", false);
        if ( !bReturn )
          return;
        bReturn = bReturn && checkDate( document.all.endDate, "End Date", false);
        if ( !bReturn ) {   // if not a valid date check for blanks, if blanks insert begin date
          //if( document.all.endDate.value == "" ) ITS 1024 - Remove auto fill of end date
          //{
          //  document.all.endDate.value = document.all.beginDate.value;  // assign begin date
          //} else {
            return;
          //}
        }

        // if begin date is greater than end date show error
        if( !validateDates( document.all.beginDate, document.all.endDate) )
          return

        // update multiple selection drop boxes logic
        updateMultSelListOptions(document.all.templatesList);  // 11201955
    }
    else
    {

      // these fields hold the entered dates
      var bEffDate;
      var eEffDate;
      var bDate;
      var eDate;
      var bDueDate;
      var eDueDate;

      ////////////////////////////////////////////
      // msc 03/07/2002 validate all other dates if entered
      ////////////////////////////////////////////
      var elements = document.forms[0].elements;
      var len = elements.length;
      for(var x=0; x < len; x++ )
      {
        var fld = elements[x];

        // if date field and date is entered
        if( fld.name == "beginEffectiveDate" && (fld.value != "" || fld.value.length != 0))
        {
            bReturn = bReturn && checkDate( fld, "Begin Effective Date", false);
            if ( !bReturn ) return;
            bEffDate = fld;
        }
        // if date field and date is entered
        if( fld.name == "endEffectiveDate" && (fld.value != "" || fld.value.length != 0 ))
        {
            bReturn = bReturn && checkDate( fld, "End Effective Date", false);
            if ( !bReturn ) return;
            eEffDate = fld;
        }
        // if date field and date is entered
        if( fld.name == "beginDate" && (fld.value != "" || fld.value.length != 0))
        {
            bReturn = bReturn && checkDate( fld, "Begin Date", false);
            if ( !bReturn ) return;
            bDate = fld;
        }
        // if date field and date is entered
        if( fld.name == "endDate" && (fld.value != "" || fld.value.length != 0))
        {
            bReturn = bReturn && checkDate( fld, "End Date", false);
            if ( !bReturn ) return;
            eDate = fld;
        }
        // if date field and date is entered
        if( fld.name == "beginDueDate" && (fld.value != "" || fld.value.length != 0))
        {
            bReturn = bReturn && checkDate( fld, "Begin Due Date", false);
            if ( !bReturn ) return;
            bDueDate = fld;
        }
        // if date field and date is entered
        if( fld.name == "endDueDate" && (fld.value != "" || fld.value.length != 0))
        {
            bReturn = bReturn && checkDate( fld, "End Due Date", false);
            if ( !bReturn ) return;
            eDueDate = fld;
        }
      }

        // validate effective date
        if( typeof bEffDate != "undefined" && typeof eEffDate != "undefined" )
        {
          // if begin date is greater than end date
          if( !validateDates( bEffDate, eEffDate ) )
            return
        }
        // validate street date
        if( typeof bDate != "undefined" && typeof eDate != "undefined" )
        {
          // if begin date is greater than end date
          if( !validateDates( bDate, eDate ) )
            return
        }
        // validate due date
        if( typeof bDueDate != "undefined" && typeof eDueDate != "undefined" )
        {
          // if begin date is greater than end date
          if( !validateDates( bDueDate, eDueDate ) )
            return
        }


    }

    // This method moves the corporate structure drop list options selected values
    // to a hidden field due to MAC issues
    reportCOS.setHiddenValuesCOS(document.all.hiddenFamilyIndex,
                              document.all.hiddenEnvironmentIndex,
                              document.all.hiddenCompanyIndex,
                              document.all.hiddenLabelIndex);

    // This method moves the Format drop list options selected values
    // to a hidden field due to MAC issues
    reportFormat.setHiddenValuesFormat(document.all.hiddenFormatIndex,
                                 document.all.hiddenSubFormatIndex);

    ////////////////////////////////////////////////////////////////////////
    // if all of the status filters have been unchecked, default to active
    ///////////////////////////////////////////////////////////////////////
    if(!document.all.status_all.checked && !document.all.status_active.checked
         && !document.all.status_tbs.checked && !document.all.status_closed.checked
         && !document.all.status_cancelled.checked)
    {
      document.all.status_active.checked = true;
    }

    ////////////////////////////////////////////////////////////////////////
    //ITS 1069 jo
    // if all of the distribution company filters have been unchecked,
    // or only the 'All checkbox (distCo0) has been checked, then default
    // all the checkboxes to active
    ///////////////////////////////////////////////////////////////////////
    var distCoSelected = false;
    //array of all distCo checkboxes
    for (i=0; i<document.reportForm.elements.length; i++){
           var distCoElement = document.reportForm.elements[i];
           if (distCoElement.type == 'checkbox'){
               //if it is named 'distCo' then set to true
               checkboxName = distCoElement.name;
               if (checkboxName.substr(0,6)=="distCo"){
                    //check to see if it is selected
                    if (distCoElement.checked == true && checkboxName!="distCo0"){
                          distCoSelected = true;
                          //leave the for loop since at least one
                          //checkbox has been checked
                          break;
                    }
               }
           }
    }

    //if the 'All' checkbox was selected or no checkboxes were chosen then select all of them
    if(!distCoSelected)
    {
       for (i=0; i<document.reportForm.elements.length; i++){
           if (document.reportForm.elements[i].type == 'checkbox'){
               //if it is named 'distCo*' then set to true
               checker = document.reportForm.elements[i];
               if ((checker.name).substr(0,6)=="distCo"){
                    //set all the distribution checkboxes
                    checker.checked = true;
               }
           }
        }
    }

    window.scrollTo(0,0);  // msc its 630 scroll to the top of the window
    document.forms[0].target= 'hiddenFrame';  // change target to the hiddenframe
    document.forms[0].cmd.value = "reports-criteria";
    showWaitMsg();  // mc its 966 show please wait message
    document.forms[0].submit();
} // end function submitSave()


function validateDates( begDate, endDate )
{
  var fStr = convertDate( begDate.value );
  var tStr = convertDate( endDate.value );
  var fTime = new Date(fStr).getTime();
  var tTime = new Date(tStr).getTime();
  // from date cannot be greater than the to date
  if ( fTime > tTime )
  {
    alert( "Begin date greater than End date: " );
    begDate.focus();
    return false;  // error
  }

  return true;  // okay
}


// msc 11201955
function updateMultSelListOptions(multSelList)
{
  // msc 11201955
  ///////////////////////////////////////////////////////
  // if multiple selectons allows and users selects all
  // flag all options as selected except All (0)
  ////////////////////////////////////////////
  var options = multSelList.options;
  var len = options.length;
  for(var x=0; x < len; x++ )
  {
    if( options[x].selected && options[x].value == "0")   // all selected
    {
      for(var i=0; i < len; i++ )
      {
        if( options[i].value == "0" )   // all selected
          options[i].selected = false; // set to unselected
        else
          options[i].selected = true;  // all others, set to selected
      }
      break;
    }
  }
}  // 11201955

function submitFirst()
{
  // MSC ITS 630 change the target of the form to the default
  document.forms[0].target= "_self";  // change target to the hiddenframe
  document.all.cmd.value = "reports-editor";

  parent.top.bottomFrame.location = "home?cmd=notepad-first&notepadType=<%=MilestoneConstants.NOTEPAD_REPORTS%>" + "&lastCommand=" + document.all.cmd.value;
}

function submitLast()
{
  // MSC ITS 630 change the target of the form to the default
  document.forms[0].target= "_self";  // change target to the hiddenframe
  document.all.cmd.value = "reports-editor";
  parent.top.bottomFrame.location = "home?cmd=notepad-last&notepadType=<%=MilestoneConstants.NOTEPAD_REPORTS%>" + "&lastCommand=" + document.all.cmd.value;
}


function submitGet( pId )
{
  // MSC ITS 630 change the target of the form to the default
  document.forms[0].target= "_self";  // change target to the hiddenframe

  parent.top.bottomFrame.location = "home?cmd=reports-editor&report-id=" + pId;
} // end function submitGet()

function submitPagging( pForward )
{
  // MSC ITS 630 change the target of the form to the default
  document.forms[0].target= "_self";  // change target to the hiddenframe
  document.all.cmd.value = "reports-editor";

  if( pForward )
  {
  	parent.top.bottomFrame.location = "<%= inf.getServletCmdURL(MilestoneConstants.CMD_NOTEPAD_NEXT)%>" + "&notepadType=" + "<%= MilestoneConstants.NOTEPAD_REPORTS%>" + "&lastCommand=" + document.all.cmd.value;
  }
  else
  {
  	parent.top.bottomFrame.location = "<%= inf.getServletCmdURL(MilestoneConstants.CMD_NOTEPAD_PREVIOUS)%>" + "&notepadType=" + "<%= MilestoneConstants.NOTEPAD_REPORTS%>" + "&lastCommand=" + document.all.cmd.value;
  }
}//end function submitPagging()

function fillAbbreviation()
{
  if( document.all.CorporateAbbreviation.value.length == 0 )
  {
    if( document.all.CorporateDescription.value.length >= 3 )
		{
      document.all.CorporateAbbreviation.value = document.all.CorporateDescription.value.substring( 0, 3 );
    }
		else
	  {
      document.all.CorporateAbbreviation.value = document.all.CorporateDescription.value;
    }
  }
} //end function fillAbbreviation()

function initSelections()
{
    createChildren();
    for( i = 0; i < lRoot.Children.length; i++ )
    {
      var newOption = new Option( lRoot.Children[ i ].Name, "" + lRoot.Children[ i ].ID, i == 0, i == 0 );
      document.all.label.options[ i ] = newOption;
    }
    adjustSelection( document.all.label );
}//end initSelections

var lRoot;
function Node( pID, pName, pChildren )
{
  this.ID = pID;
  this.Name = pName;
  this.Children = pChildren;
}//Node


<%= context.getDelivery("CorporateArrays") %>;

function adjustSelection( pSelection ) {
  switch( pSelection.name ) {
    case "label":
        clearBox( document.all.Parent2Selection );
        if( lRoot.Children.length > 0 ) {
          fillSelection( document.all.company,
                         lRoot.Children[ document.all.label.selectedIndex ] );
        }
    case "company":
      clearBox( document.all.family );
      if( lRoot.Children.length > 0 ) {
        if( lRoot.Children[ document.all.label.selectedIndex ].Children.length > 0 ) {
            fillSelection( document.all.family,
                           lRoot.Children[ document.all.label.selectedIndex ].Children[ document.all.company.selectedIndex ] );
        }
      }

  }
}//end adjustSelection

function clearBox( pSelection ) {
  pSelection.options.length = 0;
}//end clearBox

function fillSelection( pSelection, pEntry ) {
  var lChildren = pEntry.Children;
  for( i = 0; i < lChildren.length; i++ ) {
    var newOption = new Option( lChildren[ i ].Name, lChildren[ i ].ID, i == 0, i == 0 );
    pSelection.options[ i ] = newOption;
  }
}//fill Selection

function showPrintStatus()
{
  if ( ( typeof document.all[ 'printStatus' ] ) != "object" )
    return;

  layer = eval( document.all[ 'printStatus' ] )
  layer.style.visibility = "visible";
  return;
}

function hidePrintStatus()
{
  if ( ( typeof document.all[ 'printStatus' ] ) != "object" )
    return;

  layer = eval( document.all[ 'printStatus' ] )
  layer.style.visibility = "hidden";
  return;
}

<!-- JR - ITS #70 -->
<%= context.getDelivery("configArrays") %>

function getSelectedValues (select) {
 var r = new Array();
 for (var i = 0; i < select.options.length; i++)
   if (select.options[i].selected)
     r[r.length] = select.options[i].value;
 return r;
}

function getSelectedIndices (select) {
 var r = new Array();
 for (var i = 0; i < select.options.length; i++)
   if (select.options[i].selected)
     r[r.length] = i;
 return r;
}

function getSelectedTexts (select) {
 var r = new Array();
 for (var i = 0; i < select.options.length; i++)
   if (select.options[i].selected)
     r[r.length] = select.options[i].text;
 return r;
}


function getSubconfigs(num)
{
//jo - ITS# 712 - Updated to build list of subconfigs
//using the configsProdType array to get the index number
//for the Configs array, rather than just use the selected
//index of the config select since there can now be
//Physical and/or Digital configs in the select

	if (document.forms[0].subconfigurationList == null)
             return;

        //build arrays of the chosen configs
	var selections = getSelectedIndices(document.forms[0].configurationList);
	var selectionsText = getSelectedTexts(document.forms[0].configurationList);
	var selectionsValue = getSelectedValues(document.forms[0].configurationList);
	document.forms[0].subconfigurationList.selectedIndex = 0;
	var count = 1;

        //If 'All' selected then return
        if (selectionsValue=="All"){
             //only display the 'All' option
             document.forms[0].subconfigurationList.length = 1;
             return;
        }

        //for each of the configs chosen
        for(k=0; k<selections.length; k++){

                currentConfig = selectionsValue[k];
                currentConfigDescription = selectionsText[k];

                //get the index by iterating through configsProdType
                //looking for the selected code
                for (j = 1; j < configsProdType.length; j++)
                {
                   selectedConfig = j;
                   s1 = configsProdType[selectedConfig];
                   s2 = s1.substring(0, s1.indexOf(","));
                   s3 = s1.substring(s1.indexOf(",")+1);
                   s3 = s3.substring(0, s3.indexOf(","));
                   if ( currentConfig== s3)
                       break;
                }

                   for(i=1; i<configs[selectedConfig].length; i++)
                   {
                     s1 = configs[selectedConfig][i];
                     s2 = s1.substring(0, s1.indexOf(","));
                     s3 = s1.substring(s1.indexOf(",")+1);
                     s4 = s3.substring(s3.indexOf(",")+1);
                     s4 = s4.substring(0,s4.indexOf(",")); // JP 9/30/03

                     s3 = s3.substring(0, s3.indexOf(","));

                     //s2 = [CONFIGCODE]SUBCONFIGCODE
                     s2 = "[" + currentConfig +"]" + s2;
                     //s3 = [CONFIG DESCRIPTION]SUBCONFIG DESCRIPTION
                     s3 = "[" + currentConfigDescription + "]" + s3;

                     document.forms[0].subconfigurationList.options[count] = new Option(s3,s2);
                     count++;
                   }
        }//for each of the subconfigs chosen

   document.forms[0].subconfigurationList.length = count;
} //end function getSubconfigs()

//ITS 476
//
// If checkField is the 'AllActivity' checkbox
// then deselect the other 4 Product Activity checkboxes
//
// If checkField is 'ChangesActivity' 'AllActivity' 'AddsActivity' 'CancelsActivity' 'DeletesActivity' checkbox
// then deselect the the 'AllActivity' checkbox

// JR - Rules revised
// 1. if AllActivity is checked, then check all boxes
// 2. if AllActivity is unchecked, then uncheck all the boxes
// 3. if users uncheck a changes,cancel,adds,or deletes boxes then unchecked the AllActivity checkbox
// jo its 852 - added 'Moves' section
function productActivitySelected(checkbox){
     if (checkbox.id=="AllActivity"){
         document.all.ChangesActivity.checked = document.all.AllActivity.checked;
         document.all.CancelsActivity.checked = document.all.AllActivity.checked;
         document.all.DeletesActivity.checked = document.all.AllActivity.checked;
         document.all.AddsActivity.checked  = document.all.AllActivity.checked;
         document.all.MovesActivity.checked = document.all.AllActivity.checked;
     } else if (checkbox.id!="AllActivity" && document.all.AllActivity.checked) {
         document.all.AllActivity.checked = false;
     }
}

</SCRIPT>


<link rel="stylesheet" type="text/css" href="<%= inf.getHtmlDirectory() %>global.css" title="GlobalStyle">
</head>

<script for="document" event="onkeydown" language="JavaScript">
	checkShortcut();
</script>

<!-- start body  onBlur="hidePrintStatus();" - JP -->
<body topmargin="0" leftmargin="0" onLoad="focusField( 'beginDate' );" >

<%=form.renderStart()%>
<%=form.getElement("cmd")%>

<!-- JR - ENT Report Fixes -->
<%if (form.getElement("hiddenLabel") != null) {%>
<%=form.getElement("hiddenLabel")%>
<%}%>

<%if (form.getElement("hiddenCompany") != null) {%>
<%=form.getElement("hiddenCompany")%>
<%}%>

<%if (form.getElement("hiddenCompanyIndex") != null) {%>
<%=form.getElement("hiddenCompanyIndex")%>
<%}%>

<%if (form.getElement("hiddenEnvironmentIndex") != null) {%>
<%=form.getElement("hiddenEnvironmentIndex")%>
<%}%>

<%if (form.getElement("hiddenLabelIndex") != null) {%>
<%=form.getElement("hiddenLabelIndex")%>
<%}%>

<%if (form.getElement("hiddenFamilyIndex") != null) {%>
<%=form.getElement("hiddenFamilyIndex")%>
<%}%>

<%if (form.getElement("hiddenFormatIndex") != null) {%>
<%=form.getElement("hiddenFormatIndex")%>
<%}%>

<%if (form.getElement("hiddenSubFormatIndex") != null) {%>
<%=form.getElement("hiddenSubFormatIndex")%>
<%}%>


<input type="hidden" name="reportsEditPrintWindow" value="">

<!-- JR - ITS 213 -->
<%if (form.getElement("OrderBy") != null)
    {%>
<%= form.getElement("OrderBy")%>
<%}%>
<%if (form.getElement("OrderByDirection") != null)
    {%>
<%= form.getElement("OrderByDirection")%>
<%}%>

<table width=780 cellpadding=0 border=0>
  <tr valign="middle" align="left">
    <td width=280>
      <!-- This part of the code is made an include to make it easy to manage this page.
       The include just gets and puts the code here as it was written here. -->
      <%@ include file="include-newSelection.shtml" %>
    </td>
    <td rowspan=2 width=10>
      <img src="<%= inf.getImageDirectory() %>pixelshim.gif" width=10>
    </td>
    <td width=170 >
      <SPAN class="title">Reports</SPAN>
    </td>
    <td width=85></td>
    <td width=85></td>
    <td width=85></td>
    <td width=85>
      <div align="center" id="saveDiv">
	    <a href="JavaScript:submitSave()"
		   onMouseOver="Javascript:mtbPrint.over();return true;"
		   onMouseOut="Javascript:mtbPrint.out()"
		   onClick="return true;">
		   <img name="Print" src="<%= inf.getImageDirectory() %>Print_On.gif" width="66" height="14" border="0" hspace="0" vspace="0" align="absmiddle">
	    </a>
	    <script type="text/javascript" language="JavaScript">
        	var mtbPrint = new ToggleButton(document, '<%= inf.getImageDirectory() %>', 'Print', 'JavaScript:submitSave( "Print" )', 66,14);
	    </script>
	  </div>

    </td>
    <td>
      <div align="center">
        <a href ="JavaScript:helpConext()"
          onMouseOver="Javascript:mtbHelp.over();return true;"
          onMouseOut="Javascript:mtbHelp.out()"
          onClick="Javascript:mtbHelp.click(); return true;">
          <img name="Help" id="Help" src="<%=inf.getImageDirectory()%>Help_On.gif" border=0 hspace=0 vspace=0 align="absmiddle">
        </a>
        <script type="text/javascript" language="JavaScript" >
           var mtbHelp = new ToggleButton(document, '<%=inf.getImageDirectory()%>', 'Help', "JavaScript:helpConext()",66, 14);
        </script>
      </div>

    </td>


  </tr>

  <tr>


<%//notepad visibility check
if(context.getDelivery("isNotePadVisible") == null || (context.getDelivery("isNotePadVisible") != null && ((Boolean)context.getDelivery("isNotePadVisible")).booleanValue()))
{%>
  <% /* ===============start reports navigation panel===========================
       This part of the code is made an include to make it easy to manage this page.
       The the java script needed resides in this page.
       The include just gets and puts the code here as it was written here.
     */
  %>
    <td valign="top">
     <%@ include file="include-reports-notepad.shtml" %>
   </td>

 <% /* ===============end reports navigation panel=========================== */ %>
<%}%>

  <td bgcolor="lavender" valign="top" align="left" colspan="6" width="100%">
<%
//System.out.println("currentReport:" + currentReport);
if (currentReport != null)
{%>
  <table width="100%" height="100%" cellpadding="5" border="0">
		<tr>
			<td valign="top">
				<table width=100% class="tightDetailList" border="0">
        <tr>

        <td colspan=7 width=100%>
        <table width=100% border=0>
        <tr>

      <% if (currentReport.getBeginDateFlag())
         {%>
	      <td width=10% nowrap><b>Begin Street Date&nbsp;</b></td>
		    <td width=10%>
		     <%= form.getElement("beginDate")%>
		    </td>

		    <td width=20%>
		     &nbsp;
		    </td>

       <%}%>


      <% if (currentReport.getEndDateFlag())
         {%>
		    <td width=10% nowrap><b>Ending Street Date&nbsp;</b></td>
		    <td width=10%>
            <%= form.getElement("endDate")%>
		    </td>
       <%}%>

       </tr>

       <tr>
      <% if (currentReport.getBeginDueDateFlag())
         {%>
	      <td width=10% nowrap><b>Begin Due Date&nbsp;</b></td>
		  <td width=10%>
		   <%= form.getElement("beginDueDate")%>
		  </td>

		    <td width=20%>
		     &nbsp;
		    </td>
       <%}%>


      <% if (currentReport.getEndDueDateFlag())
         {%>
		  <td width=10% nowrap><b>Ending Due Date&nbsp;</b></td>
		  <td width=10%>
            <%= form.getElement("endDueDate")%>
		  </td>
       <%}%>

        </tr>

        <tr>
      <% if (currentReport.getBeginEffectiveDateFlag())
         {%>
	      <td width=10% nowrap><b>Begin Effective Date&nbsp;</b></td>
		    <td width=10%>
		     <%= form.getElement("beginEffectiveDate")%>
		    </td>

		    <td width=20%>
		     &nbsp;
		    </td>

       <%}%>


      <% if (currentReport.getEndEffectiveDateFlag())
         {%>
		    <td width=10% nowrap><b>Ending Effective Date&nbsp;</b></td>
		    <td width=10%>
            <%= form.getElement("endEffectiveDate")%>
		    </td>
       <%}%>

       </tr>

       </table>
       </td>

       </tr>
        <tr><td colspan=7><hr noshade></tr>
        <tr>
       <% if (currentReport.getRegionFlag())
          {%>
	      <td width=20%><b>Distribution</b></td>
	      <td nowrap colspan=1>
		    <%= form.getElement("distribution")%>
	      </td>
        <%}%>
        </tr>
        <tr>
       <% //ITS 1069 - jo - Distribution Company
       if (currentReport.getDistCo())
          {%>
	      <td width=20%><b>Dist Company</b></td>
	      <td nowrap colspan=1>
                     <%= form.getElement("distCo0")%><br>
                     <%
                       Hashtable distCoHash = MilestoneHelper_2.getDistCoNames();
                       Enumeration distCo = distCoHash.keys();
                       Vector distIDs = new Vector();
                       while (distCo.hasMoreElements())
                              distIDs.addElement(distCo.nextElement());

                       for (int distCoCounter = 0; distCoCounter<distIDs.size(); distCoCounter++){
                                Integer discoIdInt = (Integer)distIDs.elementAt(distCoCounter);
                                int discoId = discoIdInt.intValue();
                                String checkBoxID = "distCo" + Integer.toString(discoId);%>
                                <%= form.getElement(checkBoxID)%>
                       <% } %>

	      </td>
        <%}%>
        </tr>
        
        <tr>
        	<% if (currentReport.getProductGroupCodeFlag())
        		{%>
        		<td width=20%><b>Production Group Code</b></td>
			      <td nowrap colspan=1>
				    <%= form.getElement("productionGroupCode")%>
			      </td>
		        <%}%>
        </tr>
        
        <tr>
       <% if (currentReport.getReleaseTypeFlag())
          {%>
	      <td width=20%><b>Release Type</b></td>
	      <td nowrap colspan=1>
		    <%= form.getElement("releaseType")%>
	      </td>
        <%}%>
        </tr>
        <tr>
      <% if (currentReport.getStatusFlag())
         {%>
        <td width=20%><b>Status</b></td>
        <td nowrap colspan=1>
        <% // MSC 12/01/2003 ITS 630  %>
        <%= form.getElement("status_all")%>
        <br>
        <%= form.getElement("status_active")%>
        <%= form.getElement("status_tbs")%>
        <%= form.getElement("status_closed")%>
        <%= form.getElement("status_cancelled")%>
      </td>
       <%}%>
        </tr>
         <tr>
      <% //contact is Label Contact
         if (currentReport.getContactFlag())
         {%>
          <td width=20%><b>Label Contact</b></td>
   	      <td nowrap colspan=1>
		      <%= form.getElement("contact")%>
	        </td>
       <%}%>
        </tr>
        <tr>
      <% if (currentReport.getFuture1Flag())
         {%>
          <td width=20%><b>UML Contact</b></td>
   	      <td nowrap colspan=1>
		      <%= form.getElement("umlContact")%>
	        </td>
       <%}%>
        </tr>
        <tr>
      <% if (currentReport.getCompleteKeyTaskFlag())
         {%>
          <td width=20%><b>Key Dates Only?</b></td>
   	      <td nowrap colspan=1>
   		    <%= form.getElement("keyDatesOnly")%>
	        </td>
       <%}%>
        </tr>
         <tr>
      <% if (currentReport.getCompleteKeyTaskFlag())
         {%>
          <td width=20%><b>Complete Key Task?</b></td>
   	      <td nowrap colspan=1>
   		    <%= form.getElement("completeKeyTask")%>
	        </td>
       <%}%>
        </tr>
        <tr>
      <% if (currentReport.getUmlDatesFlag())
         {%>
          <td width=20%><b>UML Dates?</b></td>
   	      <td nowrap colspan=1>
   		    <%= form.getElement("umlDates")%>
	        </td>
       <%}%>
        </tr>
        <tr>
      <% if (currentReport.getUmlKeyTaskFlag())
         {%>
          <td width=20%><b>Task Owner</b></td>
   	      <td nowrap colspan=1>
   		    <%= form.getElement("umlKeyTask")%>
	        </td>
       <%}%>
        </tr>
        <tr>
       <% if (currentReport.getArtistFlag())
          {%>
 	      <td width=20%><b>Artist</b></td>
	      <td>
		    <%= form.getElement("artist")%>
	      </td>
        <%}%>
        </tr>
         <!-- jo Item 1850  ------------------------  -->
        <tr>
       <% if (currentReport.getScheduledReleasesFlag())
          {%>
 	      <td width=20%><b>Scheduled Releases</b></td>
	      <td>
		    <%= form.getElement("scheduledReleases")%>
                    Only Releases with Schedules applied
	      </td>
        <%}%>
        </tr>
         <!-- jo Item 1850  ------------------------  -->
	 <!-- jr Item 37  ------------------------  -->
        <tr>
        <% if (currentReport.getAddsMovesBoth())
	   {%>
	      <td width=20%><b>Add/Moves/Both</b></td>
	      <td>
		    <%= form.getElement("AddsMovesBoth")%>

	      </td>
	 <%}%>
	 </tr>
	 <!-- jr Item 37  ------------------------  -->
	 <!-- jo Item 476 ------------------------  -->
	 <tr>
	 <% if (currentReport.getPhysicalProductActivity())
	   {%>
	      <td width=20%><b>Physical Product Activity</b></td>
	      <td>
                    <%= form.getElement("AllActivity")%><br>
		    <%= form.getElement("ChangesActivity")%>
                    <%= form.getElement("DeletesActivity")%>
                    <%= form.getElement("AddsActivity")%>
                    <%= form.getElement("CancelsActivity")%>
                    <%= form.getElement("MovesActivity")%> <!-- jo its 852 - added 'Moves' section -->
	      </td>
	 <%}%>
	 </tr>
	 <!-- jo Item 476  ------------------------  -->
        <tr>
      <% if (currentReport.getParentsOnlyFlag())
         {%>
          <td width=20%><b>Parents Only</b></td>
   	      <td nowrap colspan=1>
   		    <%= form.getElement("ParentsOnly")%>
	        </td>
       <%}%>
        </tr>
         <tr>
       <% if (currentReport.getFuture2Flag())
          {%>
 	      <td width=20%><b>Future2 ?</b></td>
	      <td>
		    <%= form.getElement("Future2")%>
	      </td>
        <%}%>
        </tr>
        <tr>
      <% if (currentReport.getFamilyFlag())
         {%>
	       <td width=45%><b>Releasing Family</b></td>

               <td width=25%>
                 <input type="radio" name="family_radio" value="All" checked onclick="reportCOS.removeSelectCOS('family')">All
                 <input type="radio" name="family_radio" value="Select" onclick="showSelect('family')">Select
               </td>

               <td colspan=1 width="50%">
                 <div style="visibility:hidden;display:none">
		    <%= form.getElement("family")%>
                 </div>
               </td>
              </tr>

              <tr>
                <td colspan=7 width="100%">
                 <div id="family_Div" style="visibility:hidden"></div>
               </td>
              </tr>

              <tr>
               <td colspan=7><hr noshade>

        <%}%>
        </tr>
        <tr>
      <% if (currentReport.getEnvironmentFlag())
         {%>
           <td width=25%><b>Environment</b></td>

            <td width=25%>
                <input type="radio" name="environment_radio" value="All" checked onclick="reportCOS.removeSelectCOS('environment')">All
                <input type="radio" name="environment_radio" value="Select" onclick="showSelect('environment')">Select
             </td>

 	      <td colspan=1 width="50%">
               <div style="visibility:hidden;display:none">
		    <%= form.getElement("environment")%>
               </div>
	      </td>
              </tr>

              <tr>
               <td colspan=7  width="100%" >
                <div id="environment_Div" style="visibility:hidden"></div>
              </td>
              </tr>
              <tr>
               <td colspan=7><hr noshade>

        <%}%>
        </tr>
        <tr>
      <% if (currentReport.getCompanyFlag())
         {%>
	      <td width=25%><b>Company</b></td>

            <td width=25%>
                <input type="radio" name="company_radio" value="All" checked onclick="reportCOS.removeSelectCOS('company')">All
                <input type="radio" name="company_radio" value="Select" onclick="showSelect('company')">Select
             </td>


	      <td colspan=1 width="50%">
                 <div style="visibility:hidden;display:none">
		    <%= form.getElement("company")%>
                 </div>
	      </td>
              </tr>
              <tr>
               <td colspan=7 width="100%" >
                <div id="company_Div" style="visibility:hidden"></div>
              </td>
              </tr>
              <tr>
               <td colspan=7><hr noshade>
       <%}%>
        </tr>
        <tr>
      <% if (currentReport.getLabelFlag())
         {%>
	      <td width=25%><b>Label</b></td>

            <td width=25%>
                <input type="radio" name="Label_radio" value="All" checked onclick="reportCOS.removeSelectCOS('Label')">All
                <input type="radio" name="Label_radio" value="Select" onclick="showSelect('Label')">Select
             </td>

	      <td colspan=1 width="50%">
                <div style="visibility:hidden;display:none">
		    <%= form.getElement("Label")%>
                </div>
	      </td>
              </tr>

              <tr>
               <td colspan=7  width="100%">
                <div id="Label_Div" style="visibility:hidden"></div>
               </td>
              </tr>
              <tr>
               <td colspan=7><hr noshade>
        <%}%>
        </tr>

       <!-- msc Item 1916  ------------------------  -->
       <tr>
      <% if (currentReport.getConfiguration() )
         {%>
         <!-- JR ITS - 277 --><!-- JO ITS 712 -->
	      <td width=45%><b>Format/Schedule Type</b></td>

              <td width=25%>
                <input type="radio" name="configurationList_radio" value="All" checked onclick="reportFormat.removeSelectFormat('configurationList')">All
                <input type="radio" name="configurationList_radio" value="Select" onclick="Format.showSelect('configurationList')">Select
              </td>

              <td nowrap colspan=1>
               <div style="visibility:hidden;display:none">
		    <%= form.getElement("configurationList")%>
               </div>
	      </td>
              </tr>

              <tr>
               <td colspan=7  width="100%" >
                <div id="configurationList_Div" style="visibility:hidden"></div>
               </td>
              </tr>
              <tr>

              <td colspan=7><hr noshade>

        <%}%>
        </tr>
       <!-- msc Item 1916 -----------------------  -->
       <!-- jr Item 39  ------------------------  -->
       <tr>
       <% if (currentReport.getSubconfigFlag() )
	{%>
	<!-- JR ITS - 277 -->
             <td width=20% nowrap><b>Sub-Format</b></td>

              <td width=25%>
                <input type="radio" name="subconfigurationList_radio" value="All" checked onclick="reportFormat.removeSelectFormat('subconfigurationList')">All
                <input type="radio" name="subconfigurationList_radio" value="Select" onclick="Format.showSelect('subconfigurationList')">Select
              </td>

	     <td nowrap colspan=1>
               <div style="visibility:hidden;display:none">
                 <%= form.getElement("subconfigurationList")%>
               </div>
             </td>

              <tr>
               <td colspan=7 width="100%" >
                <div id="subconfigurationList_Div" style="visibility:hidden"></div>
               </td>
              </tr>

              <tr>
                <td colspan=7><hr noshade>
       <%}%>
       </tr>
      <!-- jr Item 39  ------------------------  -->
       <!-- jo Item 335  ------------------------  -->
       <tr>
       <% if (currentReport.getProductType()==MilestoneConstants.BOTH)
	{%>
             <td width=20% nowrap><b>Product Type</b></td>
	     <td nowrap colspan=1>
	    <%= form.getElement("ProductType")%>
      </td>
       <%}%>
       </tr>
      <!-- j0 Item 335  ------------------------  -->
       <!-- msc eInitRelSched ------------------------  -->
       <tr>
      <% if ( form.getElement("eInitRelList") != null )
         {%>
	      <td width=20%><b>Sort Order</b></td>
              <td nowrap colspan=1>
		    <%= form.getElement("eInitRelList")%>
	      </td>
        <%}%>
        </tr>
       <!-- msc eInitRelSched -----------------------  -->

       <!-- msc Item 2069 -----------------------  -->
       <!-- msc templatesList ------------------------  -->
       <tr>
      <% if ( form.getElement("templatesList") != null )
         {%>
	      <td width=20%><b>Templates</b></td>
              <td nowrap colspan=1>
		    <%= form.getElement("templatesList")%>
	      </td>
        <%}%>
        </tr>
       <!-- msc templatesList -----------------------  -->
       <td width=85>
         <div align="center" id="saveDivBottom" colspan=4>
	    <a href="JavaScript:submitSave()"
		   onMouseOver="Javascript:mtbPrint2.over();return true;"
		   onMouseOut="Javascript:mtbPrint2.out()"
		   onClick="return true;">
		   <img name="Print2" src="<%= inf.getImageDirectory() %>Print_On.gif" width="66" height="14" border="0" hspace="0" vspace="0" align="absmiddle">
	    </a>
	    <script type="text/javascript" language="JavaScript">
        	var mtbPrint2 = new ToggleButton(document, '<%= inf.getImageDirectory() %>', 'Print', 'JavaScript:submitSave( "Print" )', 66,14);
	    </script>
	  </div>

       </td>

        </table>
      </td>
    </tr>
  </table>
  </td>
  </tr>

  </table>
</div>

<!-- JR - ITS 213 - 03/26/03 -->
<%/* DIV definitions
     start search div */%>
<div class="search" id="SearchLayer" onKeyPress="checkForEnter('submitSearch()');" style="visibility:hidden">
<table width="100%" border="1" cellspacing="0" cellpadding="1">
<tr><td>
	<table width="100%">
	<tr><th colspan="2">Report Search</th></tr>
	<tr>
		<td class="label">Description</td>
		<td><%= form.getElement("ReportDescriptionSearch") %></td>
	</tr>
	<tr><td colspan="2"><INPUT type=button value="Submit Search" onClick="submitSearch()">
		  <colspan="2"><input type="button" name="SubmitCancel" id="SubmitCancel" value="Cancel" onClick="Javascript:HideLayer()">
</td></tr>
	</table>
</td></tr></table>
</div>
<%/* end search div
     END DIV DEFINITIONS */%>
<!-- JR - ITS 213 - 03/26/03 -->

<%=form.renderEnd()%>



<div class="search" id="ProjectSearchLayer" style="position:absolute;visibility:hidden;width:800px;height:450px;z-index:10;left:75px;top:50px;border: outset wheat 5px">
        <IFRAME HEIGHT="450" width="800" ID="ProjectSearchFrame" name="ProjectSearchFrame"  FRAMEBORDER=0 SCROLLING=NO >">
        </IFRAME>
</div>


<%@ include file="include-bottom-html.shtml"%>


<!-- onclick="showPrintStatus();" -JP -->

<DIV id="printWindow" style="position:absolute; visibility:hidden; z-index:0; left: 365px; top: 8px;">
<table width="200" border=0 cellspacing=0 cellpadding=0>
  <tr align=center valign="bottom" align="left">
    <td align=center width=100>
    <script>
    document.writeln("<a href ='" + printPdflink + "'  target='hiddenFrame'>");
    //document.writeln("PRINT TO PDF");
    // msc ITS42
    document.writeln("<img name=Print id=Print src=<%=inf.getImageDirectory()%>Print_On.gif border=0 hspace=0 vspace=0 align=absmiddle>");
    document.writeln("</a>");
    </script>
    </td>
  </tr>
</table>
</div>

<%
if (context.getDelivery("readyToPrint") != null)
{
	  //String htmlTitle = "Report Summary";
    //get current report from session
    //Report currentReport = (Report)context.getSessionValue("report");
com.universal.milestone.Form reportForm = (com.universal.milestone.Form)context.getSessionValue("reportForm");
%>
<SCRIPT>
layer = eval( document.all[ 'printWindow' ] )
layer.style.visibility = "visible";
</SCRIPT>
<%
}
%>

<SCRIPT>

// *******************************************************
// MSC 10/22/03
// Old COS select box build logic
// Now using COS object
// *******************************************************
function oldLogic()
{

// MSC AFE 2003 Save the Labels options
var saveLabelOptions = new Array();
if (document.forms[0].Label)
{
  for(var i=0; i < document.forms[0].Label.options.length; i++)
  {
    saveLabelOptions[i] = new Option(document.forms[0].Label.options[i].text, document.forms[0].Label.options[i].value);
  }
  //alert(" options length " + saveLabelOptions.length);
}
// MSC AFE 2003 Save the Comany options
var saveCompanyOptions = new Array();
if (document.forms[0].company)
{
  for(var i=0; i < document.forms[0].company.options.length; i++)
  {
    saveCompanyOptions[i] = new Option(document.forms[0].company.options[i].text, document.forms[0].company.options[i].value);
  }
  //alert(" options length " + saveCompanyOptions.length);
}

// MSC AFE 2003
var tempFamily = 0;
var tempEnvironment = 0;
var tempCompany = 0;
var tempLabel = 0;
var navCom = navigator.platform;

if(document.forms[0].family)
  tempFamily = document.forms[0].family.value;

if(document.forms[0].environment)
  tempEnvironment = document.forms[0].environment.value;

if (document.forms[0].company)
{
  tempCompany = document.forms[0].company.value;
}

if (document.forms[0].Label)
{
  tempLabel = document.forms[0].Label.value;
}


if(document.forms[0].family && tempFamily != 0)
{
  if(navCom.substr(0,3).toUpperCase() == "MAC" )
    document.all.family.selectedIndex =  document.all.hiddenFamilyIndex.value;

   clickFamily(document.forms[0].family);
}

if(document.forms[0].environment && tempEnvironment != 0)
{
  document.forms[0].environment.value = tempEnvironment;

  if(navCom.substr(0,3).toUpperCase() == "MAC" )
    document.all.environment.selectedIndex =  document.all.hiddenEnvironmentIndex.value;

  clickEnvironment(document.forms[0].environment);
}

if (document.forms[0].company && tempCompany != 0)
{
  document.all.company.value =  document.all.hiddenCompany.value;

  if(navCom.substr(0,3).toUpperCase() == "MAC" )
   document.all.company.selectedIndex =  document.all.hiddenCompanyIndex.value;

  clickCompany(document.forms[0].company);


}

// MSC AFE 2003, find Label in options
if (document.forms[0].Label && document.all.hiddenLabel.value != 0)
{

  document.forms[0].Label.value = document.all.hiddenLabel.value;

  document.all.Label.selectedIndex = document.all.hiddenLabelIndex.value;

  //alert("label index = " + document.all.hiddenLabelIndex.value);

  /*
  // MSC AFE 2003, Find possible duplicate label names value in label options array
  // duplicate values stored as comma delimitted string
  var opts = document.forms[0].Label.options;
  var labelValue = document.all.hiddenLabel.value;
  //alert("label value = " + labelValue);
  if(opts && labelValue != 0)
  {
   //alert("opts length = " + opts.length);
    for(var i=0; i < opts.length; i++)
    {
      if(opts[i].value.indexOf(labelValue) != -1)
       {
         opts[i].selected=true;
         document.forms[0].Label.value = opts[i].value;
         break;
       }
    }
  }
  */
 }
}
// end of oldLogic function
</script>



<% //-- include js file, the COS building class methods--%>
<script type="text/javascript" language="javascript" src="<%= inf.getHtmlDirectory() %>include-jscript-clickCOS.js"></script>
<script type="text/javascript" language="javascript" src="<%= inf.getHtmlDirectory() %>include-jscript-clickFormat.js"></script>

<script>

///////////////////////////////////////////////////////////////////////////////////
// Instantiate a new COS object
//////////////////////////////////////////////////////////////////////////////////
var reportCOS = new COS(document.all.family,document.all.environment,
                        document.all.company,document.all.division,
                        document.all.Label,true)  // msc mult select


// Change the corporate search elements onChange event handlers functions
// to point the new Class methods
if(document.all.family)
  document.all.family.onchange = function() { return(reportCOS.clickFamilySearch(this)); }
if(document.all.environment)
  document.all.environment.onchange = function() { return(reportCOS.clickEnvironmentSearch(this)); }
if(document.all.company)
  document.all.company.onchange = function() { return(reportCOS.clickCompanySearch(this)); }

///////////////////////////////////////////////////////////////////////////////////
// Instantiate a new Format object
//////////////////////////////////////////////////////////////////////////////////
var reportFormat = new Format(document.all.configurationList,document.all.subconfigurationList);

// build the sub-format list box, the list is empty from the server
if(document.all.subconfigurationList)
{
  reportFormat.refreshAll = true;
  reportFormat.clickFormat();  // rebuild all sub formats
  // save all sub formats
  Format.populateChildFromAllFormat(reportFormat.subFormatObjAll,reportFormat.subFormatObj);

}

// Change the Format elements onChange event handlers functions
// to point the new Class methods
if(document.all.configurationList)
  document.all.configurationList.onchange = function() { return(reportFormat.clickFormat(this)); }

var selValue = "0";

<%
// get the user object from the session
User userRE = (User)context.getSessionValue("user");
if (userRE != null && userRE.getPreferences() != null) {

    if (userRE.getPreferences().getReportsReleasingFamily() > 0)
    {
     %>
     // build the lower level drop downs
     if(document.all.family)
     {
       document.all.family_radio[1].checked = true;
       COS.buildLowerLevels("family");
       showSelect('family');
     }
   <%
    }
    if (userRE.getPreferences().getReportsEnvironment() > 0)
    {
     %>
     // build the lower level drop downs
     if(document.all.environment)
     {
       var selValue = "<%=userRE.getPreferences().getReportsEnvironment()%>";
       COS.setValuesIndex(document.all.environment,selValue);
       COS.buildLowerLevels("environment");
       document.all.environment_radio[1].checked = true;
       showSelect('environment');
     }
   <%
    }

}
%>

</SCRIPT>

<%
} //end report !=null
else
{
%>
</body>
<%
}
%>